<!doctype html><html lang=en><head><title>Benchmarking Go Sort Functions ::
masoudkf — Developer Blog
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=" Sorting Slices with the Go Standard Library # The standard library comes with several functions to sort a slice. In this post I&rsquo;ll take a look at the following functions and benchmark them to see which one runs faster.
sort.Slice sort.SliceStable slices.SortFunc slices.SortStableFunc slices.Sort I&rsquo;ll be sorting a slice of integers in this post. In a later post, I&rsquo;ll add more complex types.
Note: All these functions sort the slice in-place and change the slice.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://masoudkarimif.github.io/posts/benchmarking-go-sort-functions/><link rel=stylesheet href=/css/style.css><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Fira+Code&display=swap" rel=stylesheet><link rel=stylesheet href=https://masoudkarimif.github.io/style.css><link rel=apple-touch-icon-precomposed sizes=144x144 href=https://masoudkarimif.github.io/img/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=https://masoudkarimif.github.io/img/favicon.png><link href=/fonts/Inter-Italic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Regular.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Medium.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-MediumItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-Bold.woff2 rel=preload type=font/woff2 as=font crossorigin><link href=/fonts/Inter-BoldItalic.woff2 rel=preload type=font/woff2 as=font crossorigin><meta name=twitter:card content="summary"><meta name=twitter:title content="Benchmarking Go Sort Functions"><meta name=twitter:description content="Go's standard library comes with several sort functions to sort a slice. In this post, I'll go over some of them to see which one runs faster."><meta property="og:url" content="https://masoudkarimif.github.io/posts/benchmarking-go-sort-functions/"><meta property="og:site_name" content="masoudkf"><meta property="og:title" content="Benchmarking Go Sort Functions"><meta property="og:description" content="Go's standard library comes with several sort functions to sort a slice. In this post, I'll go over some of them to see which one runs faster."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-10-05T00:00:00+00:00"><meta property="article:modified_time" content="2024-10-05T00:00:00+00:00"><meta property="article:tag" content="Go"><meta property="article:tag" content="Sort"><meta property="article:tag" content="Performance"><meta property="article:tag" content="Algorithms"><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZFRSZRJSCV"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZFRSZRJSCV")}</script></head><body class=light-theme><div class=container><header class=header><span class=header__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>masoudkf</span>
</a><span class=header__right><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/about>About</a></li><li><a href=/reads>Reads</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/about>About</a></li><li><a href=/reads>Reads</a></li></ul></nav><span class=menu-trigger><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
</span><span class=theme-toggle><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none"><path d="M22 41c10.4934.0 19-8.5066 19-19C41 11.5066 32.4934 3 22 3 11.5066 3 3 11.5066 3 22s8.5066 19 19 19zM7 22C7 13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22z"/></svg></span></span></span></header><div class=content><article class=post><h1 class=post-title>Benchmarking Go Sort Functions</h1><div class=post-meta><time class=post-date>2024-10-05
</time><span class=post-author>— by masoudkf</span>
<span class=post-read-time>— 6 min read</span></div><span class=post-tags><a href=https://masoudkarimif.github.io/tags/go/>#go</a>&nbsp;
<a href=https://masoudkarimif.github.io/tags/sort/>#sort</a>&nbsp;
<a href=https://masoudkarimif.github.io/tags/performance/>#performance</a>&nbsp;
<a href=https://masoudkarimif.github.io/tags/algorithms/>#algorithms</a>&nbsp;</span><div class=post-content><br><p align=center><img src=https://res.cloudinary.com/mkf/image/upload/v1728180506/gopher-sorting_rzxv7b.jpg width=600></p><br><h2 id=sorting-slices-with-the-go-standard-library>Sorting Slices with the Go Standard Library
<a href=#sorting-slices-with-the-go-standard-library class=h-anchor aria-hidden=true>#</a></h2><p>The standard library comes with several functions to sort a slice. In this post I&rsquo;ll take a look at the following functions and benchmark them to see which one runs faster.</p><ul><li><code>sort.Slice</code></li><li><code>sort.SliceStable</code></li><li><code>slices.SortFunc</code></li><li><code>slices.SortStableFunc</code></li><li><code>slices.Sort</code></li></ul><p>I&rsquo;ll be sorting a slice of integers in this post. In a later post, I&rsquo;ll add more complex types.</p><p>Note: All these functions sort the slice in-place and change the slice.</p><hr><h3 id=a-note-on-stable-vs-non-stable-sorting-algorithms>A Note on Stable vs. Non-Stable Sorting Algorithms
<a href=#a-note-on-stable-vs-non-stable-sorting-algorithms class=h-anchor aria-hidden=true>#</a></h3><p>A stable sorting algorithm retains the relative order of equal items, but a non-stable doesn&rsquo;t guarantee to do that. For example, if you&rsquo;re sorting students based on the grade they got on their midterm and on the unsorted list, <code>Alice</code> appears before <code>John</code> although they both got 90/100, a stable sort will sort the grades but will make sure that <code>Alice</code> still appears before <code>John</code>. A non-stable one may change that order and have <code>John</code> appear first.</p><h4 id=does-it-matter>Does it Matter?
<a href=#does-it-matter class=h-anchor aria-hidden=true>#</a></h4><p>Although in some occassions that wouldn&rsquo;t be such a big deal, but in other situations it might be important. Take, for example, a recommendation system that shows you the products you may be interested in buying. Based on your preferences, you get shirts first, then pants, then wallets. Now assume you want to sort the recommendation based on price and it just so happens that some shirts have the same price as some pants and wallets. If you do a non-stable sort, the result may show you wallets first, then pants, and then shirts, which is not ideal since you&rsquo;re more interested to buy shirts. However, a stable sort will make sure that if there are shirts, pants, and wallets with the same price in the recommendation, they retain the relative order after the sorting is done; i.e. you will still see shirts and pants first, and then wallets.</p><p>On the other hand, if you&rsquo;re sorting a list (slice) of numbers, it won&rsquo;t matter. Generally speaking, non-stable sorting algorithms run a tad faster than stable ones, so it&rsquo;s important to pick the one that matches your use case best.</p><hr><h2 id=sorting-functions-from-the-sort-package>Sorting Functions From the <code>sort</code> Package
<a href=#sorting-functions-from-the-sort-package class=h-anchor aria-hidden=true>#</a></h2><h3 id=sortslice><code>sort.Slice</code>
<a href=#sortslice class=h-anchor aria-hidden=true>#</a></h3><p>This <a href=https://pkg.go.dev/sort#Slice>function</a>, sorts a slice given a less function. It will panic if the input is not a slice. Here&rsquo;s the signature, where <code>x</code> is the slice to be sorted, and <code>less</code> is the function that shows if item with index <code>i</code> is smaller (less) than item with index <code>j</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Slice</span>(<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>any</span>, <span style=color:#a6e22e>less</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>bool</span>)
</span></span></code></pre></div><p>Here&rsquo;s an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>sort</span>.<span style=color:#a6e22e>Slice</span>(<span style=color:#a6e22e>mySlice</span>, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>bool</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mySlice</span>[<span style=color:#a6e22e>i</span>] &lt; <span style=color:#a6e22e>mySlice</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>This less function will sort the slice ascendingly. To do the reverse (or descendingly), change the less function to return <code>false</code> if item <code>i</code> is bigger than item <code>j</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>sort</span>.<span style=color:#a6e22e>Slice</span>(<span style=color:#a6e22e>mySlice</span>, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>bool</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mySlice</span>[<span style=color:#a6e22e>i</span>] &gt; <span style=color:#a6e22e>mySlice</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><h3 id=sortslicestable><code>sort.SliceStable</code>
<a href=#sortslicestable class=h-anchor aria-hidden=true>#</a></h3><p>Same as <code>sort.Slice</code> with only one difference: it performs an stable sort on the slice and therefore retains the relative order of the equal items. Here&rsquo;s the signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>SliceStable</span>(<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>any</span>, <span style=color:#a6e22e>less</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>bool</span>)
</span></span></code></pre></div><p>Everything else, including the usage, is the same as <code>sort.Slice</code></p><h2 id=sorting-functions-from-the-slices-package>Sorting Functions From the <code>slices</code> Package
<a href=#sorting-functions-from-the-slices-package class=h-anchor aria-hidden=true>#</a></h2><p>Aside from sort functions from the <a href=https://pkg.go.dev/sort><code>sort</code></a> package, we have a number of sort functions from the <a href=https://pkg.go.dev/slices><code>slices</code></a> package, too.</p><h3 id=slicessortfunc><code>slices.SortFunc</code>
<a href=#slicessortfunc class=h-anchor aria-hidden=true>#</a></h3><p>This is the <a href=https://pkg.go.dev/slices#SortFunc>function</a> that the Go documentation recommends to be used instead of the older <code>sort.Slice</code>. Here&rsquo;s the quote from the docs:</p><blockquote><p>Note: in many situations, the newer <code>slices.SortFunc</code> function is more ergonomic and runs faster [than <code>sort.Slice</code>].</p></blockquote><p>Here&rsquo;s the signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>SortFunc</span>[<span style=color:#a6e22e>S</span> ~[]<span style=color:#a6e22e>E</span>, <span style=color:#a6e22e>E</span> <span style=color:#a6e22e>any</span>](<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>S</span>, <span style=color:#a6e22e>cmp</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span> <span style=color:#a6e22e>E</span>) <span style=color:#66d9ef>int</span>)
</span></span></code></pre></div><p>It can sort any slice given a <code>cmp</code> function that shows if item <code>a</code> is bigger than <code>b</code> or not. For an ascending sort, the function must return a negative number if <code>a &lt; b</code>, a positive number if <code>a > b</code>, and <code>0</code> if they&rsquo;re equal. Note that this is a bit different that the less function we saw earlier. That function was supposed to return a <code>bool</code>, but this <code>cmp</code> function is supposed to return an <code>int</code>. Another difference is that the less function takes the indices of two items, but the <code>cmp</code> function takes the actual items. So, remember that.</p><p>Here&rsquo;s an example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>slices</span>.<span style=color:#a6e22e>SortFunc</span>(<span style=color:#a6e22e>mySlice</span>, <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span> <span style=color:#66d9ef>int</span>) <span style=color:#66d9ef>int</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>a</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>b</span>
</span></span><span style=display:flex><span>})
</span></span></code></pre></div><p>If you want to sort the slice in descending order, change <code>return a - b</code> to <code>return b - a</code>.</p><h3 id=slicessortstablefunc><code>slices.SortStableFunc</code>
<a href=#slicessortstablefunc class=h-anchor aria-hidden=true>#</a></h3><p>Same as <code>slices.SortFunc</code>, but stable. Here&rsquo;s the signature:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>SortStableFunc</span>[<span style=color:#a6e22e>S</span> ~[]<span style=color:#a6e22e>E</span>, <span style=color:#a6e22e>E</span> <span style=color:#a6e22e>any</span>](<span style=color:#a6e22e>x</span> <span style=color:#a6e22e>S</span>, <span style=color:#a6e22e>cmp</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>a</span>, <span style=color:#a6e22e>b</span> <span style=color:#a6e22e>E</span>) <span style=color:#66d9ef>int</span>)
</span></span></code></pre></div><p>Everything else is the same as <code>slices.SortFunc</code>.</p><h3 id=slicessort><code>slices.Sort</code>
<a href=#slicessort class=h-anchor aria-hidden=true>#</a></h3><p>This is a special <a href=https://pkg.go.dev/slices#Sort>function</a>. First, it can only sort the slice in ascending order. Second, the slice must have items that satisfy the <a href=https://pkg.go.dev/cmp#Ordered><code>cmp.Ordered</code></a> constraint. Here&rsquo;s the constraint:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Ordered</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>	~<span style=color:#66d9ef>int</span> | ~<span style=color:#66d9ef>int8</span> | ~<span style=color:#66d9ef>int16</span> | ~<span style=color:#66d9ef>int32</span> | ~<span style=color:#66d9ef>int64</span> |
</span></span><span style=display:flex><span>		~<span style=color:#66d9ef>uint</span> | ~<span style=color:#66d9ef>uint8</span> | ~<span style=color:#66d9ef>uint16</span> | ~<span style=color:#66d9ef>uint32</span> | ~<span style=color:#66d9ef>uint64</span> | ~<span style=color:#66d9ef>uintptr</span> |
</span></span><span style=display:flex><span>		~<span style=color:#66d9ef>float32</span> | ~<span style=color:#66d9ef>float64</span> |
</span></span><span style=display:flex><span>		~<span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>As you can see, it only contains primitive types that support these operators: <code>&lt; &lt;= >= ></code>. In other words, if you want to sort your slice in descending order, or sort a slice whose items are not primitive (e.g. they include custom types), you can&rsquo;t use this function and need to use another one such as <code>slices.SliceFunc</code>. But for our example here which is sorting a slice of integers, this will work.</p><hr><h2 id=benchmark>Benchmark
<a href=#benchmark class=h-anchor aria-hidden=true>#</a></h2><p>For the benchmark, I create a slice of <code>int</code> with 1,000,000 random numbers. I use the same seed for all the functions to make sure the benchmark is fair. Here&rsquo;s the code:</p><script src=https://gist.github.com/masoudkarimif/c899f7464c1dbf19315abffa93c45763.js></script><p>I ran the benchmark using <code>go test -bench=. -benchmem -run=X</code> on a MacBook Air 2024 (with Apple M3 Chip, 8 cores, 16 GB RAM) many times and every time I got the same ranking, although the actual numbers were different. Here&rsquo;s one of them:</p><pre tabindex=0><code>goos: darwin
goarch: arm64
pkg: sort-bench
BenchmarkSortSlice-8                         579           2163180 ns/op           31163 B/op          2 allocs/op
BenchmarkSortSliceStable-8                   312           3454498 ns/op           57784 B/op          2 allocs/op
BenchmarkSlicesSortFunc-8                    618           2186051 ns/op           29144 B/op          0 allocs/op
BenchmarkSlicesSortStableFunc-8              493           2334498 ns/op           36534 B/op          0 allocs/op
BenchmarkSlicesSort-8                       2019            575471 ns/op            8921 B/op          0 allocs/op
</code></pre><p>And here&rsquo;s the chart for visual-lovers:</p><br><p align=center><img src=https://res.cloudinary.com/mkf/image/upload/v1728179639/bench-2_azlrwa.png width=600></p><br><h3 id=conclusion>Conclusion
<a href=#conclusion class=h-anchor aria-hidden=true>#</a></h3><p>One thing that&rsquo;s clear is that the stable sorts run slower than the non-stable ones: <code>sort.SliceStable</code> runs slower than <code>sort.Slice</code>, and <code>slices.SortStableFunc</code> runs slower than <code>slices.SortFunc</code>.</p><p>Also, <code>slices.SortStableFunc</code> runs faster than <code>sort.SliceStable</code>, which is what the Go docs promises. However, <code>slices.SortFunc</code> seems to be more or less the same as <code>sort.Slices</code>. But all in all, and given that this is just one example of one type (<code>int</code>), I think we should stick to the documentation and use the newer functions from the <code>slices</code> package over the older ones from the <code>sort</code> package.</p><p>The interesting one here is the <code>slices.Sort</code> that runs <strong>way</strong> faster than the others. It&rsquo;s probably because it doesn&rsquo;t take a function to call on every comparison unlike the other ones; so lower overhead during sorting. But remember that this function only does ascending order and only works for slices of primitive types, such as <code>int</code> and <code>float32</code>. So, there&rsquo;s a chance we can&rsquo;t use this function in many occassions.</p><p>Finally, if you&rsquo;re interested in what is happening behind the scenes for these sort functions, the non-stable ones use a custom Quick Sort, and the stable ones use Merge Sort. Can you find them in the source code <a href=https://cs.opensource.google/go/go/+/refs/tags/go1.23.2:src/>here</a>?</p><p>Here&rsquo;s the one for <a href="https://cs.opensource.google/go/go/+/refs/tags/go1.23.2:src/slices/sort.go;l=30"><code>slices.SortFunc</code></a>.</p></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://masoudkarimif.github.io/posts/heaps-dont-lie/><span class=button__icon>←</span>
<span class=button__text>Heaps Don't Lie; They Save Lives</span>
</a></span><span class="button next"><a href=https://masoudkarimif.github.io/posts/starting-with-github-actions/><span class=button__text>Starting with GitHub Actions</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><a href=/ class=logo style=text-decoration:none><span class=logo__mark><svg class="greater-icon" viewBox="0 0 44 44"><path fill="none" d="M15 8l14.729 14.382L15 35.367"/></svg>
</span><span class=logo__text>masoudkf</span></a><div class=copyright><span>© 2024 Powered by
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a></span>
<span>Theme created by
<a href=https://twitter.com/panr target=_blank rel=noopener>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZFRSZRJSCV"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZFRSZRJSCV")}</script></body></html>